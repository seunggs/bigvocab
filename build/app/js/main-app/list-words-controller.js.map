{"version":3,"sources":["main-app/list-words-controller.es6"],"names":[],"mappings":"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","file":"main-app/list-words-controller.js","sourcesContent":["(() => {\r\n  'use strict';\r\n\r\n  class ListWordsCtrl {\r\n    constructor($stateParams, CollectionsService, WordsService, TextConvertService, ConfigService, DictionaryService, $timeout, user, ngAudio) {\r\n\r\n      let vm = this;\r\n\r\n\t\t\t// config ////////////////////////////////////////////////////////////////////////////\r\n\r\n      vm.formData = {};\r\n      vm.showEdit = {};\r\n      vm.displayLimit = 200;\r\n      vm.btnState = {\r\n        loading: false,\r\n        success: false\r\n      };\r\n      vm.notification = {\r\n        success: false,\r\n        error: false\r\n      };\r\n      vm.msg = {\r\n        success: 'Change successfully saved!',\r\n        deleteSuccess: 'Word deleted succesfully',\r\n        error: 'Something went wrong. Please try again.',\r\n        pronunciationError: 'Sorry - pronunciation for this word cannot be found.'\r\n      };\r\n      vm.notificationSuccessMsg = vm.msg.success;\r\n      vm.notificationErrorMsg = vm.msg.error;\r\n\r\n\t\t\t// init //////////////////////////////////////////////////////////////////////////////\r\n\r\n\t\t\tgetAllWords(user.id);\r\n\r\n      if ($stateParams.searchString !== null) { \r\n        vm.formData.searchWords = $stateParams.searchString; \r\n      }\r\n\r\n      document.getElementById('searchWords').focus();\r\n\r\n      // helper functions //////////////////////////////////////////////////////////////////\r\n\r\n      function submitErrorHandler (err) {\r\n        vm.btnState.loading = false;\r\n        vm.notification.error = true;\r\n        console.log('Something went wrong: ', err);\r\n      }\r\n\r\n      function getAllWords (userId) {\r\n\t      WordsService.getUserAll(userId)\r\n\t      \t.then(res => {\r\n\t      \t\tvar words = angular.fromJson(res).data;\r\n\r\n\t      \t\tvm.words = words;\r\n\t      \t\tvm.wordsCount = words.length;\r\n\r\n            vm.words.map(word => {\r\n              word.definition = TextConvertService.fromHtml(word.definition);\r\n              return word;\r\n            });\r\n\r\n\t      \t\tinitShowEdit(words);\r\n\t      \t})\r\n\t      \t.catch(submitErrorHandler);\r\n      }\r\n\r\n      function initShowEdit (words) {\r\n      \twords.map(word => {\r\n      \t\tvm.showEdit[word.id] = false;\r\n      \t\treturn word;\r\n      \t});\r\n      }\r\n\r\n      // main //////////////////////////////////////////////////////////////////////////////\r\n\r\n      vm.toggleEdit = word => {\r\n    \t\tvm.formData.word = word.word;\r\n\t  \t\tvm.formData.definition = word.definition;\r\n\r\n      \tvm.showEdit[word.id] = !vm.showEdit[word.id];\r\n      };\r\n\r\n      vm.modalYes = wordId => {\r\n        WordsService.delete(wordId)\r\n          .then(() => {\r\n            // update the current view to reflect the removal\r\n            var currentWord = vm.words.filter(currentWord => {\r\n              return currentWord.id === wordId;\r\n            })[0];\r\n            var index = vm.words.indexOf(currentWord);\r\n            vm.words.splice(index, 1);\r\n\r\n            vm.notificationSuccessMsg = vm.msg.deleteSuccess;\r\n            vm.notification.success = true;\r\n          })\r\n          .catch(submitErrorHandler);\r\n      };\r\n\r\n      vm.modalClose = () => {\r\n        vm.showModal = false;\r\n        // delete the item on local\r\n      };\r\n\r\n      vm.playPronunciation = word => {\r\n        DictionaryService.getPronunciation(ConfigService.forvoKey, word.word)\r\n          .then(pronunciationPath => {\r\n            vm.pronunciation = pronunciationPath !== null ? ngAudio.load(pronunciationPath) : null;\r\n            if (vm.pronunciation !== null) {\r\n              vm.pronunciation.play();\r\n            } else {\r\n              vm.notificationErrorMsg = vm.msg.pronunciationError;\r\n              vm.notification.error = true;\r\n            }\r\n          })\r\n          .catch(err => {\r\n            console.log('Something went wrong: ', err);\r\n          });\r\n      };\r\n\r\n      vm.saveChanges = (isValid, word, formData) => {\r\n      \tif (!isValid) { return; }\r\n\r\n      \tWordsService.update(word.id, formData)\r\n      \t\t.then(() => {\r\n            vm.btnState.loading = false;\r\n            vm.btnState.success = true;\r\n\r\n            vm.notificationSuccessMsg = vm.msg.success;\r\n            vm.notification.success = true;\r\n\r\n            $timeout(() => {\r\n              vm.btnState.success = false;\r\n\t\r\n\t            vm.showEdit[word.id] = !vm.showEdit[word.id];\r\n\r\n\t            // update the current view to reflect the change\r\n\t            vm.words.map(currentWord => {\r\n\t            \tif (currentWord.id === word.id) {\r\n\t            \t\tcurrentWord.word = vm.formData.word;\r\n\t            \t\tcurrentWord.definition = TextConvertService.fromHtml(vm.formData.definition);\r\n\t            \t}\r\n\r\n\t            \treturn currentWord;\r\n\t            }); \r\n            }, 1500);\r\n      \t\t})\r\n      \t\t.catch(submitErrorHandler);\r\n      };\r\n\r\n      vm.submitDelete = wordId => {\r\n        vm.showModal = true;\r\n        vm.selectedWordId = wordId;\r\n      };\r\n\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @ngdoc object\r\n   * @name mainApp.controller:ListWordsCtrl\r\n   *\r\n   * @description\r\n   *\r\n   */\r\n  angular\r\n    .module('mainApp')\r\n    .controller('ListWordsCtrl', ListWordsCtrl);\r\n}());\r\n"],"sourceRoot":"/source/"}